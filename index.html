<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>健身计划制定器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #f6f8fc 0%, #e9f0f7 100%);
            min-height: 100vh;
        }
        .input-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }
        .input-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.2);
        }
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 8px -1px rgba(37, 99, 235, 0.3);
        }
        .section-title {
            color: #1e40af;
            font-weight: 700;
            position: relative;
            padding-bottom: 0.5rem;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 3rem;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            border-radius: 3px;
        }
        .form-group {
            background: #f8fafc;
            border-radius: 0.5rem;
            padding: 1rem;
            transition: all 0.3s ease;
        }
        .form-group:hover {
            background: #f1f5f9;
        }
        .form-label {
            color: #475569;
            font-weight: 500;
        }
        .form-input {
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            padding: 0.5rem;
            transition: all 0.3s ease;
        }
        .form-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .checkbox-group {
            background: #f8fafc;
            border-radius: 0.5rem;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }
        .checkbox-group:hover {
            background: #f1f5f9;
        }
        .checkbox-label {
            color: #475569;
            font-weight: 500;
        }
        .required-badge {
            background: #fee2e2;
            color: #dc2626;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            margin-left: 0.5rem;
        }
        .optional-badge {
            background: #e0f2fe;
            color: #0284c7;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            margin-left: 0.5rem;
        }
        .results-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-top: 2rem;
        }
        .progress-bar {
            height: 0.5rem;
            background: #e2e8f0;
            border-radius: 0.25rem;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            border-radius: 0.25rem;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="py-8 px-4 md:px-8">
    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">健身计划制定器</h1>
            <p class="text-lg text-gray-600">根据您的身体状况和目标，制定个性化的健身计划</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- 当前身体状况 -->
            <div class="input-card p-6">
                <h2 class="section-title text-2xl mb-6">当前身体状况</h2>
                <form id="currentForm" class="space-y-6">
                    <!-- 基本信息 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            基本信息
                            <span class="required-badge">必填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">身高 (cm)</label>
                                <input type="number" name="height" required class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">体重 (kg)</label>
                                <input type="number" name="weight" required class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 运动能力 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            运动能力
                            <span class="optional-badge">选填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">单杠数量（个）</label>
                                <input type="number" name="pullups" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">3公里用时（分钟）</label>
                                <input type="number" name="running" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">仰卧起坐（个/分钟）</label>
                                <input type="number" name="sit_ups" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">俯卧撑（个/分钟）</label>
                                <input type="number" name="push_ups" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">深蹲（个/分钟）</label>
                                <input type="number" name="squats" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">平板支撑（秒）</label>
                                <input type="number" name="plank" class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 心肺功能 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            心肺功能
                            <span class="optional-badge">选填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">静息心率（次/分钟）</label>
                                <input type="number" name="resting_heart_rate" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">最大摄氧量（ml/kg/min）</label>
                                <input type="number" name="vo2max" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">肺活量（ml）</label>
                                <input type="number" name="vital_capacity" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">心率恢复时间（分钟）</label>
                                <input type="number" name="heart_rate_recovery" class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 柔韧性 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            柔韧性
                            <span class="optional-badge">选填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">坐位体前屈（厘米）</label>
                                <input type="number" name="sit_and_reach" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">肩部柔韧性（厘米）</label>
                                <input type="number" name="shoulder_flexibility" class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 个人健康信息 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            个人健康信息
                            <span class="required-badge">必填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="form-label block mb-2">年龄</label>
                                <input type="number" name="age" required class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">性别</label>
                                <select name="gender" required class="form-input w-full">
                                    <option value="">请选择</option>
                                    <option value="male">男</option>
                                    <option value="female">女</option>
                                </select>
                            </div>
                        </div>

                        <div class="checkbox-group mb-4">
                            <label class="form-label block mb-2">健康状况（可多选）</label>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div class="flex items-center">
                                    <input type="checkbox" name="health_conditions" value="none" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">无</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="health_conditions" value="heart_disease" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">心脏病</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="health_conditions" value="hypertension" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">高血压</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="health_conditions" value="diabetes" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">糖尿病</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="health_conditions" value="asthma" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">哮喘</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="health_conditions" value="joint_issues" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">关节问题</label>
                                </div>
                            </div>
                        </div>

                        <div class="checkbox-group mb-4">
                            <label class="form-label block mb-2">运动习惯</label>
                            <div class="grid grid-cols-1 gap-4">
                                <div class="flex items-center">
                                    <input type="checkbox" name="exercise_habits" value="none" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">无运动习惯</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="exercise_habits" value="regular" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">有规律运动</label>
                                </div>
                            </div>
                        </div>

                        <!-- 运动详情（当选择"有规律运动"时显示） -->
                        <div id="exerciseDetails" class="hidden space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="form-label block mb-2">每周运动频率</label>
                                    <select name="exercise_frequency" class="form-select">
                                        <option value="">请选择</option>
                                        <option value="1-2">1-2次/周</option>
                                        <option value="3-4">3-4次/周</option>
                                        <option value="5-6">5-6次/周</option>
                                        <option value="7+">7次以上/周</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label block mb-2">每次运动时长</label>
                                    <select name="exercise_duration" class="form-select">
                                        <option value="">请选择</option>
                                        <option value="30min">30分钟以内</option>
                                        <option value="30-60min">30-60分钟</option>
                                        <option value="60-90min">60-90分钟</option>
                                        <option value="90min+">90分钟以上</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label class="form-label block mb-2">主要运动项目（可多选）</label>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="running" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">跑步</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="swimming" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">游泳</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="cycling" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">骑行</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="gym" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">健身房</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="yoga" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">瑜伽</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="basketball" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">篮球</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="football" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">足球</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="badminton" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">羽毛球</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" name="exercise_types" value="other" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label class="ml-2 text-sm text-gray-700">其他</label>
                                    </div>
                                </div>
                            </div>

                            <!-- 跑步详情 -->
                            <div id="runningDetails" class="hidden space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="form-label block mb-2">平均每次跑步距离（公里）</label>
                                        <input type="number" name="running_distance" class="form-input" min="0" step="0.1">
                                    </div>
                                    <div>
                                        <label class="form-label block mb-2">平均配速（分钟/公里）</label>
                                        <input type="number" name="running_pace" class="form-input" min="0" step="0.1">
                                    </div>
                                </div>
                            </div>

                            <!-- 游泳详情 -->
                            <div id="swimmingDetails" class="hidden space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="form-label block mb-2">平均每次游泳距离（米）</label>
                                        <input type="number" name="swimming_distance" class="form-input" min="0" step="50">
                                    </div>
                                    <div>
                                        <label class="form-label block mb-2">主要泳姿</label>
                                        <select name="swimming_style" class="form-select">
                                            <option value="">请选择</option>
                                            <option value="freestyle">自由泳</option>
                                            <option value="breaststroke">蛙泳</option>
                                            <option value="backstroke">仰泳</option>
                                            <option value="butterfly">蝶泳</option>
                                            <option value="mixed">混合泳</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- 健身房详情 -->
                            <div id="gymDetails" class="hidden space-y-4">
                                <div>
                                    <label class="form-label block mb-2">主要训练项目（可多选）</label>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                        <div class="flex items-center">
                                            <input type="checkbox" name="gym_types" value="strength" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label class="ml-2 text-sm text-gray-700">力量训练</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" name="gym_types" value="cardio" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label class="ml-2 text-sm text-gray-700">有氧训练</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" name="gym_types" value="hiit" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label class="ml-2 text-sm text-gray-700">HIIT</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" name="gym_types" value="yoga" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label class="ml-2 text-sm text-gray-700">瑜伽</label>
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" name="gym_types" value="pilates" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label class="ml-2 text-sm text-gray-700">普拉提</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="checkbox-group mb-4">
                            <label class="form-label block mb-2">饮食习惯</label>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div class="flex items-center">
                                    <input type="checkbox" name="diet_habits" value="none" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">无</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="diet_habits" value="regular" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">规律饮食</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="diet_habits" value="irregular" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">不规律饮食</label>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" name="diet_habits" value="vegetarian" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label class="ml-2 text-sm text-gray-700">素食</label>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="form-label block mb-2">平均每日睡眠时间（小时）</label>
                            <input type="number" name="sleep_hours" required class="form-input w-full">
                        </div>

                        <div>
                            <label class="form-label block mb-2">其他健康相关说明</label>
                            <textarea name="health_notes" rows="3" class="form-input w-full"></textarea>
                        </div>
                    </div>
                </form>
            </div>

            <!-- 目标身体状况 -->
            <div class="input-card p-6">
                <h2 class="section-title text-2xl mb-6">目标身体状况</h2>
                <form id="targetForm" class="space-y-6">
                    <!-- 基础目标 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            基础目标
                            <span class="required-badge">必填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">目标身高 (cm)</label>
                                <input type="number" name="targetHeight" required class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标体重 (kg)</label>
                                <input type="number" name="targetWeight" required class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 运动能力目标 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            运动能力目标
                            <span class="optional-badge">选填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">目标单杠数量（个）</label>
                                <input type="number" name="targetPullups" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标3公里用时（分钟）</label>
                                <input type="number" name="targetRunning" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标仰卧起坐（个/分钟）</label>
                                <input type="number" name="targetSitUps" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标俯卧撑（个/分钟）</label>
                                <input type="number" name="targetPushUps" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标深蹲（个/分钟）</label>
                                <input type="number" name="targetSquats" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标平板支撑（秒）</label>
                                <input type="number" name="targetPlank" class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 心肺功能目标 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            心肺功能目标
                            <span class="optional-badge">选填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">目标静息心率（次/分钟）</label>
                                <input type="number" name="targetRestingHeartRate" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标最大摄氧量（ml/kg/min）</label>
                                <input type="number" name="targetVo2max" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标肺活量（ml）</label>
                                <input type="number" name="targetVitalCapacity" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标心率恢复时间（分钟）</label>
                                <input type="number" name="targetHeartRateRecovery" class="form-input w-full">
                            </div>
                        </div>
                    </div>

                    <!-- 柔韧性目标 -->
                    <div class="form-group">
                        <h3 class="text-lg font-medium text-gray-700 mb-4">
                            柔韧性目标
                            <span class="optional-badge">选填</span>
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="form-label block mb-2">目标坐位体前屈（厘米）</label>
                                <input type="number" name="targetSitAndReach" class="form-input w-full">
                            </div>
                            <div>
                                <label class="form-label block mb-2">目标肩部柔韧性（厘米）</label>
                                <input type="number" name="targetShoulderFlexibility" class="form-input w-full">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="text-center mt-8">
            <button onclick="generatePlan()" class="btn-primary">
                生成健身计划
            </button>
        </div>

        <div id="results" class="results-card hidden">
            <!-- 结果内容将通过JavaScript动态生成 -->
        </div>
    </div>

    <script>
        function generatePlan() {
            const currentForm = document.getElementById('currentForm');
            const targetForm = document.getElementById('targetForm');
            const resultArea = document.getElementById('results');

            // 验证当前状态表单
            const currentInputs = currentForm.querySelectorAll('input[required], select[required]');
            let isCurrentFormValid = true;
            currentInputs.forEach(input => {
                if (!input.value.trim()) {
                    isCurrentFormValid = false;
                    input.classList.add('border-red-500');
                } else {
                    input.classList.remove('border-red-500');
                }
            });

            // 验证目标状态表单
            const targetInputs = targetForm.querySelectorAll('input[required]');
            let isTargetFormValid = true;
            targetInputs.forEach(input => {
                if (!input.value.trim()) {
                    isTargetFormValid = false;
                    input.classList.add('border-red-500');
                } else {
                    input.classList.remove('border-red-500');
                }
            });

            // 如果任一表单未填写完整，显示错误提示并返回
            if (!isCurrentFormValid || !isTargetFormValid) {
                alert('请填写所有必填字段！');
                return;
            }

            // 获取当前状态数据
            const currentData = {
                // 基础信息
                height: currentForm.height.value,
                weight: currentForm.weight.value,
                
                // 运动能力
                pullups: currentForm.pullups.value,
                running: currentForm.running.value,
                sit_ups: currentForm.sit_ups.value,
                push_ups: currentForm.push_ups.value,
                squats: currentForm.squats.value,
                plank: currentForm.plank.value,

                // 心肺功能
                resting_heart_rate: currentForm.resting_heart_rate.value,
                vo2max: currentForm.vo2max.value,
                vital_capacity: currentForm.vital_capacity.value,
                heart_rate_recovery: currentForm.heart_rate_recovery.value,

                // 柔韧性
                sit_and_reach: currentForm.sit_and_reach.value,
                shoulder_flexibility: currentForm.shoulder_flexibility.value,

                // 个人健康信息
                age: currentForm.age.value,
                gender: currentForm.gender.value,
                healthConditions: Array.from(currentForm.querySelectorAll('input[name="health_conditions"]:checked')).map(cb => cb.value),
                exercise_habits: document.querySelector('input[name="exercise_habits"]:checked')?.value,
                exercise_frequency: document.querySelector('select[name="exercise_frequency"]')?.value,
                exercise_duration: document.querySelector('select[name="exercise_duration"]')?.value,
                exercise_types: Array.from(document.querySelectorAll('input[name="exercise_types"]:checked')).map(cb => cb.value),
                dietHabits: Array.from(currentForm.querySelectorAll('input[name="diet_habits"]:checked')).map(cb => cb.value),
                sleepHours: currentForm.sleep_hours.value,
                healthNotes: currentForm.health_notes.value,
                running_distance: document.querySelector('input[name="running_distance"]')?.value,
                running_pace: document.querySelector('input[name="running_pace"]')?.value,
                swimming_distance: document.querySelector('input[name="swimming_distance"]')?.value,
                swimming_style: document.querySelector('select[name="swimming_style"]')?.value,
                gym_types: Array.from(document.querySelectorAll('input[name="gym_types"]:checked')).map(cb => cb.value)
            };

            // 获取目标状态数据
            const targetData = {
                // 基础目标
                height: targetForm.targetHeight.value,
                weight: targetForm.targetWeight.value,
                
                // 运动能力目标
                pullups: targetForm.targetPullups.value,
                running: targetForm.targetRunning.value,
                sit_ups: targetForm.targetSitUps.value,
                push_ups: targetForm.targetPushUps.value,
                squats: targetForm.targetSquats.value,
                plank: targetForm.targetPlank.value,

                // 心肺功能目标
                resting_heart_rate: targetForm.targetRestingHeartRate.value,
                vo2max: targetForm.targetVo2max.value,
                vital_capacity: targetForm.targetVitalCapacity.value,
                heart_rate_recovery: targetForm.targetHeartRateRecovery.value,

                // 柔韧性目标
                sit_and_reach: targetForm.targetSitAndReach.value,
                shoulder_flexibility: targetForm.targetShoulderFlexibility.value
            };

            // 验证数值的合理性
            if (!validateData(currentData, targetData)) {
                return;
            }

            // 生成计划
            const plan = generateFitnessPlan(currentData, targetData);
            
            // 显示结果
            displayResults(plan);
            resultArea.classList.remove('hidden');
        }

        function validateData(current, target) {
            // 验证身高
            if (current.height < 100 || current.height > 250 || target.height < 100 || target.height > 250) {
                alert('请输入合理的身高范围（100-250厘米）！');
                return false;
            }

            // 验证体重
            if (current.weight < 30 || current.weight > 200 || target.weight < 30 || target.weight > 200) {
                alert('请输入合理的体重范围（30-200公斤）！');
                return false;
            }

            // 验证运动能力
            if (current.pullups < 0 || target.pullups < 0) {
                alert('单杠数量不能为负数！');
                return false;
            }
            if (current.running < 5 || target.running < 5) {
                alert('请输入合理的跑步时间（至少5分钟）！');
                return false;
            }
            if (current.sit_ups < 0 || target.sit_ups < 0) {
                alert('仰卧起坐数量不能为负数！');
                return false;
            }
            if (current.push_ups < 0 || target.push_ups < 0) {
                alert('俯卧撑数量不能为负数！');
                return false;
            }
            if (current.squats < 0 || target.squats < 0) {
                alert('深蹲数量不能为负数！');
                return false;
            }
            if (current.plank < 0 || target.plank < 0) {
                alert('平板支撑时间不能为负数！');
                return false;
            }

            // 验证心肺功能
            if (current.resting_heart_rate < 40 || current.resting_heart_rate > 120 ||
                target.resting_heart_rate < 40 || target.resting_heart_rate > 120) {
                alert('请输入合理的静息心率范围（40-120次/分钟）！');
                return false;
            }
            if (current.vo2max < 20 || current.vo2max > 80 ||
                target.vo2max < 20 || target.vo2max > 80) {
                alert('请输入合理的最大摄氧量范围（20-80 ml/kg/min）！');
                return false;
            }
            if (current.vital_capacity < 1000 || current.vital_capacity > 7000 ||
                target.vital_capacity < 1000 || target.vital_capacity > 7000) {
                alert('请输入合理的肺活量范围（1000-7000 ml）！');
                return false;
            }
            if (current.heart_rate_recovery < 1 || current.heart_rate_recovery > 30 ||
                target.heart_rate_recovery < 1 || target.heart_rate_recovery > 30) {
                alert('请输入合理的心率恢复时间范围（1-30分钟）！');
                return false;
            }

            // 验证柔韧性
            if (current.sit_and_reach < -20 || current.sit_and_reach > 40 ||
                target.sit_and_reach < -20 || target.sit_and_reach > 40) {
                alert('请输入合理的坐位体前屈范围（-20-40厘米）！');
                return false;
            }
            if (current.shoulder_flexibility < 0 || current.shoulder_flexibility > 50 ||
                target.shoulder_flexibility < 0 || target.shoulder_flexibility > 50) {
                alert('请输入合理的肩部柔韧性范围（0-50厘米）！');
                return false;
            }

            // 验证年龄
            if (current.age < 12 || current.age > 80) {
                alert('请输入合理的年龄范围（12-80岁）！');
                return false;
            }

            return true;
        }

        function generateFitnessPlan(currentData, targetData) {
            // 计算BMI和体脂率
            const currentBMI = (currentData.weight / Math.pow(currentData.height / 100, 2)).toFixed(1);
            const targetBMI = (targetData.weight / Math.pow(targetData.height / 100, 2)).toFixed(1);
            
            // 根据国家体育总局《全民健身计划（2021-2025年）》制定计划
            let plan = {
                workout: [],
                diet: [],
                health: []
            };

            // 1. 基础体能训练（根据《国家体育锻炼标准》）
            const baseTraining = {
                warmup: "1. 5-10分钟热身运动\n2. 关节活动\n3. 轻度有氧运动",
                cooldown: "1. 5-10分钟放松运动\n2. 拉伸运动\n3. 深呼吸放松"
            };

            // 2. 根据年龄和健康状况调整训练强度
            const age = parseInt(currentData.age);
            let intensity = "中等";
            if (age < 18) {
                intensity = "适中";
            } else if (age > 60) {
                intensity = "轻度";
            }

            // 3. 根据《健康中国2030规划纲要》制定运动计划
            let weeklyPlan = [];
            
            // 每周至少150分钟中等强度有氧运动
            const aerobicMinutes = 150;
            const strengthDays = 2; // 每周至少2天力量训练

            // 4. 根据《全民健身指南》制定具体计划
            if (currentData.exercise_habits === 'none') {
                // 初学者计划
                weeklyPlan = [
                    {
                        day: "周一",
                        focus: "基础体能",
                        activities: [
                            "1. 快走 20分钟",
                            "2. 基础力量训练 15分钟",
                            "3. 拉伸放松 10分钟"
                        ]
                    },
                    {
                        day: "周三",
                        focus: "有氧运动",
                        activities: [
                            "1. 慢跑/快走 30分钟",
                            "2. 基础柔韧性训练 15分钟",
                            "3. 放松运动 10分钟"
                        ]
                    },
                    {
                        day: "周五",
                        focus: "综合训练",
                        activities: [
                            "1. 有氧运动 20分钟",
                            "2. 力量训练 20分钟",
                            "3. 拉伸放松 10分钟"
                        ]
                    }
                ];
            } else {
                // 有运动基础者计划
                weeklyPlan = [
                    {
                        day: "周一",
                        focus: "力量训练",
                        activities: [
                            "1. 热身运动 10分钟",
                            "2. 力量训练 40分钟",
                            "3. 有氧运动 20分钟",
                            "4. 放松拉伸 10分钟"
                        ]
                    },
                    {
                        day: "周二",
                        focus: "有氧训练",
                        activities: [
                            "1. 热身运动 10分钟",
                            "2. 有氧运动 45分钟",
                            "3. 核心训练 15分钟",
                            "4. 放松拉伸 10分钟"
                        ]
                    },
                    {
                        day: "周四",
                        focus: "力量训练",
                        activities: [
                            "1. 热身运动 10分钟",
                            "2. 力量训练 40分钟",
                            "3. 有氧运动 20分钟",
                            "4. 放松拉伸 10分钟"
                        ]
                    },
                    {
                        day: "周五",
                        focus: "有氧训练",
                        activities: [
                            "1. 热身运动 10分钟",
                            "2. 有氧运动 45分钟",
                            "3. 核心训练 15分钟",
                            "4. 放松拉伸 10分钟"
                        ]
                    }
                ];
            }

            // 5. 根据《中国居民膳食指南》制定饮食计划
            const dietPlan = {
                breakfast: [
                    "1. 全谷物主食（如全麦面包、燕麦片）",
                    "2. 优质蛋白质（如鸡蛋、牛奶）",
                    "3. 新鲜水果",
                    "4. 适量坚果"
                ],
                lunch: [
                    "1. 主食（米饭/面食）",
                    "2. 优质蛋白质（鱼/肉/豆制品）",
                    "3. 蔬菜（深色蔬菜为主）",
                    "4. 适量水果"
                ],
                dinner: [
                    "1. 主食（适量）",
                    "2. 优质蛋白质",
                    "3. 蔬菜",
                    "4. 避免高油高盐"
                ],
                snacks: [
                    "1. 水果",
                    "2. 坚果",
                    "3. 酸奶",
                    "4. 全麦饼干"
                ],
                hydration: [
                    "1. 每天饮水1500-2000ml",
                    "2. 运动时及时补充水分",
                    "3. 避免含糖饮料"
                ]
            };

            // 6. 健康建议（基于《健康中国行动》）
            const healthAdvice = [
                "1. 保持规律作息，确保充足睡眠",
                "2. 每天进行适量运动，避免久坐",
                "3. 保持良好心态，适当放松",
                "4. 定期进行体检，关注健康指标",
                "5. 注意运动安全，循序渐进"
            ];

            // 7. 特殊人群注意事项
            if (currentData.healthConditions.includes('heart_disease')) {
                healthAdvice.push("6. 心脏病患者注意事项：\n   - 避免剧烈运动\n   - 保持适度运动强度\n   - 定期监测心率\n   - 随身携带急救药物");
            }
            if (currentData.healthConditions.includes('hypertension')) {
                healthAdvice.push("7. 高血压患者注意事项：\n   - 控制运动强度\n   - 避免憋气动作\n   - 保持规律服药\n   - 定期监测血压");
            }

            // 8. 生成最终计划
            plan.workout = [
                "=== 训练计划 ===",
                `训练强度：${intensity}`,
                "每周训练安排：",
                ...weeklyPlan.map(day => 
                    `\n${day.day}（${day.focus}）：\n${day.activities.join('\n')}`
                ),
                "\n注意事项：",
                "1. 遵循循序渐进原则",
                "2. 注意运动安全",
                "3. 保持运动记录",
                "4. 适时调整计划"
            ];

            plan.diet = [
                "=== 饮食计划 ===",
                "早餐：",
                ...dietPlan.breakfast,
                "\n午餐：",
                ...dietPlan.lunch,
                "\n晚餐：",
                ...dietPlan.dinner,
                "\n加餐建议：",
                ...dietPlan.snacks,
                "\n饮水建议：",
                ...dietPlan.hydration
            ];

            plan.health = [
                "=== 健康建议 ===",
                ...healthAdvice,
                "\n=== 进度追踪 ===",
                "1. 每周记录体重变化",
                "2. 记录运动完成情况",
                "3. 记录饮食情况",
                "4. 定期评估计划效果"
            ];

            return plan;
        }

        function generateRecoveryPlan(current, day) {
            const exercises = [];
            
            // 根据不同的健康状况生成恢复计划
            if (current.healthConditions.includes('heart_disease')) {
                exercises.push(
                    '心脏康复训练：',
                    '- 5-10分钟轻度快走',
                    '- 3-5分钟休息',
                    '- 重复3-4次',
                    '注意事项：',
                    '- 保持心率在安全范围内',
                    '- 避免剧烈运动',
                    '- 如有不适立即停止'
                );
            } else if (current.healthConditions.includes('hypertension')) {
                exercises.push(
                    '血压控制训练：',
                    '- 10-15分钟轻度有氧运动',
                    '- 5-10分钟休息',
                    '- 重复2-3次',
                    '注意事项：',
                    '- 避免剧烈运动',
                    '- 保持呼吸平稳',
                    '- 定期监测血压'
                );
            } else if (current.healthConditions.includes('diabetes')) {
                exercises.push(
                    '血糖控制训练：',
                    '- 15-20分钟中等强度有氧运动',
                    '- 5分钟休息',
                    '- 重复2-3次',
                    '注意事项：',
                    '- 餐后1-2小时运动',
                    '- 准备糖果以防低血糖',
                    '- 保持充足水分'
                );
            } else if (current.healthConditions.includes('asthma')) {
                exercises.push(
                    '呼吸功能训练：',
                    '- 10-15分钟轻度有氧运动',
                    '- 5分钟休息',
                    '- 重复2-3次',
                    '注意事项：',
                    '- 避免剧烈运动',
                    '- 准备急救药物',
                    '- 保持呼吸平稳'
                );
            } else if (current.healthConditions.includes('joint_issues')) {
                exercises.push(
                    '关节康复训练：',
                    '- 10-15分钟游泳或水中运动',
                    '- 5-10分钟休息',
                    '- 重复2-3次',
                    '注意事项：',
                    '- 避免高强度冲击运动',
                    '- 保持关节活动度',
                    '- 注意疼痛反应'
                );
            }

            return exercises;
        }

        function generateDietPlan(current, target) {
            // 根据国务院发布的《中国居民膳食指南》制定饮食计划
            const dietPlan = {
                meals: [],
                snacks: [],
                hydration: {
                    dailyWater: 2000, // 基础饮水量（ml）
                    timing: [
                        '早晨起床后：300ml温水',
                        '早餐后：200ml',
                        '上午10点：200ml',
                        '午餐前：200ml',
                        '午餐后：200ml',
                        '下午3点：200ml',
                        '晚餐前：200ml',
                        '晚餐后：200ml',
                        '睡前1小时：200ml'
                    ]
                },
                specialDietaryNeeds: []
            };

            // 根据健康状况添加特殊饮食需求
            if (current.healthConditions.includes('heart_disease')) {
                dietPlan.specialDietaryNeeds.push(
                    '低盐饮食：每日盐摄入量控制在5g以下',
                    '低脂饮食：选择瘦肉，避免动物内脏',
                    '增加膳食纤维：多吃蔬菜水果',
                    '控制总热量：避免高热量食物'
                );
            }
            if (current.healthConditions.includes('hypertension')) {
                dietPlan.specialDietaryNeeds.push(
                    '严格限盐：每日盐摄入量控制在3g以下',
                    '增加钾的摄入：多吃香蕉、土豆等',
                    '控制总热量：避免高热量食物',
                    '避免酒精和咖啡因'
                );
            }
            if (current.healthConditions.includes('diabetes')) {
                dietPlan.specialDietaryNeeds.push(
                    '控制碳水化合物：选择低GI食物',
                    '定时定量：保持规律进餐',
                    '增加膳食纤维：多吃蔬菜',
                    '避免精制糖和甜食'
                );
            }

            // 生成每日饮食计划
            dietPlan.meals = [
                {
                    time: '早餐（7:00-8:00）',
                    foods: [
                        '主食：全麦面包/燕麦片（50-100g）',
                        '蛋白质：鸡蛋（1-2个）/牛奶（250ml）',
                        '蔬菜：新鲜蔬菜（100g）',
                        '水果：应季水果（100g）'
                    ]
                },
                {
                    time: '上午加餐（10:00）',
                    foods: [
                        '坚果：核桃/杏仁（30g）',
                        '水果：应季水果（100g）'
                    ]
                },
                {
                    time: '午餐（12:00-13:00）',
                    foods: [
                        '主食：糙米/全麦面（100-150g）',
                        '蛋白质：瘦肉/鱼/虾（100-150g）',
                        '蔬菜：多种蔬菜（200-300g）',
                        '豆制品：豆腐/豆干（50-100g）'
                    ]
                },
                {
                    time: '下午加餐（15:00）',
                    foods: [
                        '酸奶：低脂酸奶（200ml）',
                        '水果：应季水果（100g）'
                    ]
                },
                {
                    time: '晚餐（18:00-19:00）',
                    foods: [
                        '主食：糙米/全麦面（50-100g）',
                        '蛋白质：瘦肉/鱼/虾（100g）',
                        '蔬菜：多种蔬菜（200-300g）',
                        '汤：清淡蔬菜汤（200ml）'
                    ]
                }
            ];

            // 根据训练强度调整饮食
            if (plan.intensity === 'high') {
                dietPlan.meals.forEach(meal => {
                    if (meal.time.includes('早餐') || meal.time.includes('午餐')) {
                        meal.foods.push('额外补充：蛋白质粉（30g）');
                    }
                });
            }

            // 添加训练前后的营养补充建议
            dietPlan.snacks = [
                '训练前（30分钟）：',
                '- 香蕉（1根）',
                '- 全麦面包（1片）',
                '训练后（30分钟内）：',
                '- 蛋白质粉（30g）',
                '- 香蕉（1根）',
                '- 运动饮料（500ml）'
            ];

            return dietPlan;
        }

        function displayResults(plan) {
            const resultArea = document.getElementById('results');
            
            // 创建训练计划HTML
            const workoutHTML = `
                <div class="input-card p-6 mb-8">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">训练计划</h2>
                    <div class="space-y-4">
                        ${plan.workout.map(line => `
                            <div class="border-l-4 border-blue-500 pl-4">
                                <p class="text-gray-600">${line}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // 创建饮食计划HTML
            const dietHTML = `
                <div class="input-card p-6 mb-8">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">饮食计划</h2>
                    <div class="space-y-4">
                        ${plan.diet.map(line => `
                            <div class="border-l-4 border-green-500 pl-4">
                                <p class="text-gray-600">${line}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // 创建健康建议HTML
            const healthHTML = `
                <div class="input-card p-6 mb-8">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">健康建议</h2>
                    <div class="space-y-4">
                        ${plan.health.map(line => `
                            <div class="border-l-4 border-yellow-500 pl-4">
                                <p class="text-gray-600">${line}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // 创建进度追踪HTML
            const progressHTML = `
                <div class="input-card p-6">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">进度追踪</h2>
                    
                    <!-- 每周目标 -->
                    <div class="mb-6">
                        <h3 class="text-xl font-medium text-gray-700 mb-3">每周目标</h3>
                        ${plan.workout.slice(2).map(line => `
                            <div class="mb-4">
                                <h4 class="text-lg font-medium text-gray-700 mb-2">${line.split(': ')[1]}</h4>
                                <p class="text-gray-600">${line.split(': ')[2]}</p>
                            </div>
                        `).join('')}
                    </div>

                    <!-- 进度指标 -->
                    <div>
                        <h3 class="text-xl font-medium text-gray-700 mb-3">进度指标</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${plan.workout.slice(2).map(line => {
                                const [day, ...rest] = line.split(': ');
                                const [current, target] = rest.join(': ').split(' ');
                                return `
                                    <div class="border rounded-lg p-4">
                                        <h4 class="text-lg font-medium text-gray-700 mb-2">${day}</h4>
                                        <div class="flex justify-between items-center">
                                            <span class="text-gray-600">当前：${current}</span>
                                            <span class="text-gray-600">目标：${target}</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                                            <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${(current / target * 100)}%"></div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;

            resultArea.innerHTML = workoutHTML + dietHTML + healthHTML + progressHTML;
        }

        // 添加互斥选择功能
        document.addEventListener('DOMContentLoaded', function() {
            // 健康状况互斥选择
            const healthCheckboxes = document.querySelectorAll('input[name="health_conditions"]');
            healthCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.value === 'none' && this.checked) {
                        healthCheckboxes.forEach(cb => {
                            if (cb !== this) cb.checked = false;
                        });
                    } else if (this.checked) {
                        const noneCheckbox = document.querySelector('input[name="health_conditions"][value="none"]');
                        if (noneCheckbox) noneCheckbox.checked = false;
                    }
                });
            });

            // 运动习惯互斥选择
            const exerciseHabits = document.querySelectorAll('input[name="exercise_habits"]');
            const exerciseDetails = document.getElementById('exerciseDetails');
            const runningDetails = document.getElementById('runningDetails');
            const swimmingDetails = document.getElementById('swimmingDetails');
            const gymDetails = document.getElementById('gymDetails');

            // 运动习惯选择处理
            exerciseHabits.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        exerciseHabits.forEach(cb => {
                            if (cb !== this) cb.checked = false;
                        });
                        // 显示或隐藏运动详情
                        exerciseDetails.classList.toggle('hidden', this.value === 'none');
                    }
                });
            });

            // 运动项目选择处理
            const exerciseTypes = document.querySelectorAll('input[name="exercise_types"]');
            exerciseTypes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    // 显示或隐藏相应的详情区域
                    runningDetails.classList.toggle('hidden', !document.querySelector('input[name="exercise_types"][value="running"]').checked);
                    swimmingDetails.classList.toggle('hidden', !document.querySelector('input[name="exercise_types"][value="swimming"]').checked);
                    gymDetails.classList.toggle('hidden', !document.querySelector('input[name="exercise_types"][value="gym"]').checked);
                });
            });

            // 饮食习惯互斥选择
            const dietCheckboxes = document.querySelectorAll('input[name="diet_habits"]');
            dietCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.value === 'none' && this.checked) {
                        dietCheckboxes.forEach(cb => {
                            if (cb !== this) cb.checked = false;
                        });
                    } else if (this.checked) {
                        const noneCheckbox = document.querySelector('input[name="diet_habits"][value="none"]');
                        if (noneCheckbox) noneCheckbox.checked = false;
                    }
                });
            });
        });
    </script>
</body>
</html> 